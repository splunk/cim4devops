{
    "modelName": "Code_Vulnerabilities",
    "displayName": "Code Vulnerabilities",
    "description": "Code Vulnerabilities Data Model",
    "objectSummary": {
        "Event-Based": 1,
        "Transaction-Based": 0,
        "Search-Based": 0
    },
    "objects": [
        {
            "objectName": "Vulnerabilities",
            "displayName": "Vulnerabilities",
            "parentName": "BaseEvent",
            "comment": {
                "tags": [
                    "vulnerability",
                    "report"
                ]
            },
            "fields": [
                {
                    "fieldName": "dest_bunit",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "dest_bunit",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "dest_category",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": true,
                    "hidden": false,
                    "editable": true,
                    "displayName": "dest_category",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "dest_priority",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "dest_priority",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "severity_id",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "severity_id",
                    "comment": {
                        "description": "The numeric or vendor specific severity indicator corresponding to the event severity."
                    }
                },
                {
                    "fieldName": "signature_id",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "signature_id",
                    "comment": {
                        "description": "The unique identifier or event code of the event signature."
                    }
                },
                {
                    "fieldName": "tag",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": true,
                    "hidden": false,
                    "editable": true,
                    "displayName": "tag",
                    "comment": {
                        "description": "This automatically generated field is used to access tags from within data models. Add-on builders do not need to populate it.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "url",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "url",
                    "comment": {
                        "description": "The URL involved in the discovered vulnerability."
                    }
                },
                {
                    "fieldName": "user",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "user",
                    "comment": {
                        "description": "The user involved in the discovered vulnerability."
                    }
                },
                {
                    "fieldName": "user_bunit",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "user_bunit",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "user_category",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": true,
                    "hidden": false,
                    "editable": true,
                    "displayName": "user_category",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "user_priority",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "user_priority",
                    "comment": {
                        "description": "This field is automatically provided by asset and identity correlation features of applications like Splunk Enterprise Security. Do not define extractions for this field when writing add-ons.",
                        "ta_relevant": false
                    }
                },
                {
                    "fieldName": "repository_name",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "repository_name=*",
                    "required": true,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "repository_name",
                    "comment": ""
                },
                {
                    "fieldName": "organization",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "organization=*",
                    "required": true,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "organization",
                    "comment": ""
                },
                {
                    "fieldName": "alert.number",
                    "owner": "Vulnerabilities",
                    "type": "number",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "alert.number",
                    "comment": ""
                },
                {
                    "fieldName": "date_mday",
                    "owner": "Vulnerabilities",
                    "type": "number",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "date_mday",
                    "comment": ""
                },
                {
                    "fieldName": "date_hour",
                    "owner": "Vulnerabilities",
                    "type": "number",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "date_hour",
                    "comment": ""
                },
                {
                    "fieldName": "action",
                    "owner": "Vulnerabilities",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "status",
                    "comment": ""
                },
                {
                    "fieldName": "_time",
                    "owner": "BaseEvent",
                    "type": "timestamp",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "_time",
                    "comment": ""
                },
                {
                    "fieldName": "host",
                    "owner": "BaseEvent",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "host",
                    "comment": ""
                },
                {
                    "fieldName": "source",
                    "owner": "BaseEvent",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "source",
                    "comment": ""
                },
                {
                    "fieldName": "sourcetype",
                    "owner": "BaseEvent",
                    "type": "string",
                    "fieldSearch": "",
                    "required": false,
                    "multivalue": false,
                    "hidden": false,
                    "editable": true,
                    "displayName": "sourcetype",
                    "comment": ""
                }
            ],
            "calculations": [
                {
                    "outputFields": [
                        {
                            "fieldName": "bugtraq",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "bugtraq",
                            "comment": {
                                "description": "The identifier in the vulnerability database provided by the Security Focus website (searchable at http://www.securityfocus.com/)."
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_bugtraq",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(bugtraq) AND bugtraq!=\"\",lower(bugtraq),null())"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "category",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "category",
                            "comment": {
                                "description": "The category of the discovered vulnerability, such as DoS. Note: This field is a string. Use category_id for numeric values. The category_id field is optional and thus is not included in the data model.",
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_fillnull_category",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnull(category) OR category=\"\",\"unknown\",category)"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "cert",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "cert",
                            "comment": {
                                "description": "The identifier in the vulnerability database provided by the US Computer Emergency Readiness Team (US-CERT, searchable at http://www.kb.cert.org/vuls/)."
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_cert",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(cert) AND cert!=\"\",lower(cert),null())"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "cve",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "cve",
                            "comment": {
                                "description": "The identifier provided in the Common Vulnerabilities and Exposures index (searchable at http://cve.mitre.org).",
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_cve",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(cve) AND cve!=\"\",lower(cve),\"---\")"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "dest",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "dest",
                            "comment": {
                                "description": "The host with the discovered vulnerability. You can alias this from more specific fields, such as dest_host, dest_ip, or dest_name.",
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_fillnull_dest",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnull(dest) OR dest=\"\",\"unknown\",dest)"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "msft",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "msft",
                            "comment": {
                                "description": "The Microsoft Security Advisory number (http://technet.microsoft.com/en-us/security/advisory/)."
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_msft",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(msft) AND msft!=\"\",lower(msft),null())"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "mskb",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "mskb",
                            "comment": {
                                "description": "The Microsoft Knowledge Base article number (http://support.microsoft.com/kb/)."
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_mskb",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(mskb) AND mskb!=\"\",lower(mskb),null())"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "severity",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "severity",
                            "comment": {
                                "description": "The severity of the vulnerability detection event. Specific values are required. Use vendor_severity for the vendor's own human readable strings (such as Good, Bad, and Really Bad). Note: This field is a string. Use severity_id for numeric data types. The severity_id field is optional and not included in the data model.",
                                "expected_values": [
                                    "critical",
                                    "high",
                                    "medium",
                                    "low",
                                    "informational"
                                ],
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_fillnull_severity",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnull(severity) OR severity=\"\",if(isnull('alert.rule.security_severity_level'),\"unknown\",alert.rule.security_severity_level),severity)"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "signature",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "signature",
                            "comment": {
                                "description": "The name of the vulnerability detected on the host, such as HPSBMU02785 SSRT100526 rev.2 - HP LoadRunner Running on Windows, Remote Execution of Arbitrary Code, Denial of Service (DoS). Note: This field has a string value. Use signature_id for numeric indicators. The signature_id field is optional and thus is not included in the data model.",
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_fillnull_signature",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnull(signature) OR signature=\"\",\"unknown\",signature)"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "vendor_product",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "vendor_product",
                            "comment": {
                                "description": "The vendor and product that detected the vulnerability. This field can be automatically populated by vendor and product fields in your data.",
                                "recommended": true
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_vendor_product",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "case(isnotnull(vendor_product),vendor_product,isnotnull(vendor) AND vendor!=\"unknown\" AND isnotnull(product) AND product!=\"unknown\",vendor.\" \".product,isnotnull(vendor) AND vendor!=\"unknown\" AND (isnull(product) OR product=\"unknown\"),vendor.\" unknown\",(isnull(vendor) OR vendor=\"unknown\") AND isnotnull(product) AND product!=\"unknown\",\"unknown \".product,isnotnull(sourcetype),sourcetype,1=1,\"unknown\")"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "xref",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": true,
                            "hidden": false,
                            "editable": true,
                            "displayName": "xref",
                            "comment": {
                                "description": "A cross-reference identifier associated with the vulnerability. In most cases, the xref field contains both the short name of the database being cross-referenced and the unique identifier used in the external database."
                            }
                        }
                    ],
                    "calculationID": "Vulnerabilities_lower_xref",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(xref) AND xref!=\"\",lower(xref),\"---\")"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "rule_name",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "rule_name",
                            "comment": ""
                        }
                    ],
                    "calculationID": "hl1se52acng",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "if(isnotnull(rule_name) AND rule_name!=\"\",lower(rule_name),null())"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "t_day",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "t_day",
                            "comment": ""
                        }
                    ],
                    "calculationID": "oq07911kgg",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "strftime(_time, \"%d\")"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "t_hour",
                            "owner": "Vulnerabilities",
                            "type": "string",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "t_hour",
                            "comment": ""
                        }
                    ],
                    "calculationID": "1fyancd4up2",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "strftime(_time, \"%H\")"
                },
                {
                    "outputFields": [
                        {
                            "fieldName": "created_at",
                            "owner": "Vulnerabilities",
                            "type": "number",
                            "fieldSearch": "",
                            "required": false,
                            "multivalue": false,
                            "hidden": false,
                            "editable": true,
                            "displayName": "created_at",
                            "comment": ""
                        }
                    ],
                    "calculationID": "kh6ktbsm9r",
                    "owner": "Vulnerabilities",
                    "editable": true,
                    "comment": "",
                    "calculationType": "Eval",
                    "expression": "round(strptime('alert.created_at', \"%Y-%m-%dT%H:%M:%S%Z\"))"
                }
            ],
            "constraints": [
                {
                    "search": "(`devops_indexes`) tag=vulnerability tag=report",
                    "owner": "Vulnerabilities"
                }
            ],
            "lineage": "Vulnerabilities"
        }
    ],
    "objectNameList": [
        "Vulnerabilities"
    ]
}
